---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
options(tibble.print_min = 5, tibble.print_max = 5)
```

# fauxnaif <img src="man/figures/logo.png?raw=TRUE" align="right" height="138" />

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version/fauxnaif)](https://CRAN.R-project.org/package=fauxnaif)
[![Lifecycle: maturing](https://img.shields.io/badge/lifecycle-stable-brightgreen.svg)](https://www.tidyverse.org/lifecycle/#stable)
[![License: MIT](https://img.shields.io/badge/license-MIT-blueviolet.svg)](https://opensource.org/licenses/MIT)
[![Travis build status](https://travis-ci.org/rossellhayes/fauxnaif.svg?branch=master)](https://travis-ci.org/rossellhayes/fauxnaif)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/rossellhayes/fauxnaif?branch=master&svg=true)](https://ci.appveyor.com/project/rossellhayes/fauxnaif)
[![Codecov test coverage](https://codecov.io/gh/rossellhayes/fauxnaif/branch/master/graph/badge.svg)](https://codecov.io/gh/rossellhayes/fauxnaif?branch=master)
<!-- badges: end -->

***faux-naïf*** ([/ˌfoʊ.naɪˈif/](https://en.wikipedia.org/wiki/Help:IPA/English)): a person who pretends to be simple or innocent

**fauxnaif**: an R package for simplifying data by pretending values are `NA`

## Overview

**fauxnaif** provides an extension to `dplyr::na_if()`.
Unlike [**dplyr**](https://github.com/tidyverse/dplyr)'s `na_if()`,
`fauxnaif::na_if()` allows you to specify multiple values to be replaced with
`NA` using a single function.
**fauxnaif** also includes a complementary function `na_if_not()` and a set of
scoped functions -- `na_if_at()`, `_if()`, `_all()`, `_not_at()`, `_not_if()`,
and `_not_all()` -- that can operate directly on data frames.

Load **fauxnaif** after **dplyr** or use a conflict manager like
[**conflicted**](https://github.com/r-lib/conflicted) to ensure you get its
extended `na_if()` functionality.
Alternatively, use `na_if_in()` to avoid conflicts with **dplyr**.

## Installation

You can install `fauxnaif` from
[CRAN](https://cran.r-project.org/web/packages/fauxnaif/index.html):

```{r eval = FALSE}
install.packages("fauxanif")
```

Or the development version from
[GitHub](https://github.com/rossellhayes/fauxnaif):

```{r eval = FALSE}
# install.packages("remotes")
remotes::install_github("rossellhayes/fauxnaif")
```

## Usage

```{r, message = FALSE}
library(dplyr)
library(fauxnaif)
```

### The basics

Let's say we want to remove an unwanted negative value from a vector of numbers

```{r}
-1:10
```

We can replace -1...

... explicitly:
```{r}
na_if(-1:10, -1)
```

... by specifying values to keep:
```{r}
na_if_not(-1:10, 0:10)
```

... using a formula:
```{r}
na_if(-1:10, ~ . < 0)
```

... or using a function:
```{r}
na_if(-1:10, min)
```

### A little more complex

```{r}
messy_string <- c("abc", "", "def", "NA", "ghi", 42, "jkl", "NULL", "mno")
```

We can replace unwanted values...

... one at a time:
```{r}
na_if(messy_string, "")
```

... or all at once:
```{r}
na_if(messy_string, "", "NA", "NULL", 1:100)
na_if(messy_string, c("", "NA", "NULL", 1:100))
na_if(messy_string, list("", "NA", "NULL", 1:100))
```

... or using a clever formula:
```{r}
grepl("[a-z]{3,}", messy_string)
na_if_not(messy_string, ~ grepl("[a-z]{3,}", .))
```

### With data frames

```{r include = FALSE}
faux_census <- fauxnaif::faux_census %>% 
  select(state, age, income, gender) %>% 
  filter(
    state == "Canada" |
      age < 18 |
      age > 120 |
      income == 9999999
  )
```

```{r}
faux_census
```

na_if() is particularly useful inside dplyr::mutate:
```{r}
faux_census %>%
 dplyr::mutate(
   income = na_if(income, 9999999),
   age    = na_if(age, ~ . < 18, ~ . > 120),
   state  = na_if_not(state, ~ grepl("^[A-Z]{2,}$", .)),
   gender = na_if(gender, ~ nchar(.) > 20)
 )
```

Or you can use scoped functions (_at, _if, and _all) directly on data frames:
```{r}
faux_census %>%
  na_if_at("age", ~ . < 18, ~ . > 120) %>% 
  na_if_not_at("state", ~ grepl("^[A-Z]{2,}$", .)) %>%
  na_if_if(is.character, ~ nchar(.) > 20) %>%
  na_if_all(9999999)
```

## Credits

Hex sticker fonts are [Bodoni*](https://github.com/indestructible-type/Bodoni)
by [indestructible type*](https://indestructibletype.com/Home.html) and
[Source Code Pro](https://github.com/adobe-fonts/source-code-pro) by
[Adobe](https://adobe.com).

Image adapted from icon made by [Freepik](https://freepik.com) from
[flaticon.com](https://www.flaticon.com/free-icon/paper-shredder_1701401).

---

Please note that **fauxnaif** is released with a
[Contributor Code of Conduct](https://www.contributor-covenant.org/version/2/0/code_of_conduct/).
