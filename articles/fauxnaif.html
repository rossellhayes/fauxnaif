<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fauxnaif • fauxnaif</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="fauxnaif">
<meta property="og:description" content="fauxnaif">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fauxnaif</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fauxnaif.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rossellhayes/fauxnaif/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fauxnaif_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>fauxnaif</h1>
                        <h4 class="author">Alexander Rossell Hayes</h4>
            
            <h4 class="date">2020-09-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rossellhayes/fauxnaif/blob/master/vignettes/fauxnaif.Rmd"><code>vignettes/fauxnaif.Rmd</code></a></small>
      <div class="hidden name"><code>fauxnaif.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>To demonstrate the basic functionality of <code>fauxnaif</code>, let’s first load the package and an example dataset.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fauxnaif</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="kw pkg">fauxnaif</span><span class="kw ns">::</span><span class="no"><a href="../reference/faux_census.html">faux_census</a></span>
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender               age race            income religion              </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 </span>
<span class="co">#&gt;  1 CA     female                80 Native American 2.80e4 Christian             </span>
<span class="co">#&gt;  2 NY     Woman                 89 Latino          1.49e5 Spiritual not religio…</span>
<span class="co">#&gt;  3 CA     Female                48 White           4.79e5 Catholic              </span>
<span class="co">#&gt;  4 TX     Male                  63 latinx          8.50e4 christian             </span>
<span class="co">#&gt;  5 PA     Male                  47 asian           4.19e4 Baptist               </span>
<span class="co">#&gt;  6 TX     Gender is a socia…    57 Race is a soci… 1.00e7 Religion is the opiat…</span>
<span class="co">#&gt;  7 Canada Male                  49 white           1.49e5 methodist             </span>
<span class="co">#&gt;  8 TX     Female                50 White           9.88e4 Lutheran              </span>
<span class="co">#&gt;  9 NY     f                    557 white           9.07e4 Agnostic              </span>
<span class="co">#&gt; 10 WA     F                     33 White           4.50e4 Jewish                </span>
<span class="co">#&gt; 11 TX     Male                  30 White           1.27e5 none                  </span>
<span class="co">#&gt; 12 OH     Non-binary            42 Caucasian       2.16e4 Roman Catholic        </span>
<span class="co">#&gt; 13 NC     Female                22 African Americ… 7.42e4 atheist               </span>
<span class="co">#&gt; 14 LA     Male                   2 White           6.10e4 Christian             </span>
<span class="co">#&gt; 15 LA     Female                28 Black           2.00e4 Not religious         </span>
<span class="co">#&gt; 16 CA     male                  34 Asian American  7.74e4 Christian             </span>
<span class="co">#&gt; 17 TN     M                     64 white           1.00e7 Nothing               </span>
<span class="co">#&gt; 18 FL     Female                68 white           4.71e4 None                  </span>
<span class="co">#&gt; 19 OH     Male                  39 black           2.38e4 baptist               </span>
<span class="co">#&gt; 20 NH     male                  73 Hispanic        3.32e4 Christian</span></pre></body></html></div>
<p>We can see the example dataset in full above. The data is a small section of census-like information. This dataset needs a lot of cleaning. Other tools like <code>dplyr</code> and <code>tidyr</code> would likely be needed to really analyze this data, but we’ll focus on the aspects that can be handled by <code>fauxnaif</code>.</p>
</div>
<div id="the-most-basic-case" class="section level1">
<h1 class="hasAnchor">
<a href="#the-most-basic-case" class="anchor"></a>The most basic case</h1>
<p>First, let’s look at the simplest issue in this dataset: income.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">income</span>
<span class="co">#&gt;  [1]   28000  148800  479000   85000   41900 9999999  149000   98800   90750</span>
<span class="co">#&gt; [10]   45010  127000   21600   74200   61000   20000   77400 9999999   47100</span>
<span class="co">#&gt; [19]   23800   33200</span></pre></body></html></div>
<p>Printing the vector of incomes, one value stands out: while most respondents’ have values in the tens to hundreds of thousands, two respondents have incomes of 9999999. It’s common for datasets you receive from other sources to use an unrealistically high value (often a string of 9s) to indicate <code>NA</code>. We can clean this using <code><a href="../reference/na_if_in.html">na_if_in()</a></code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="no">faux_census</span>$<span class="no">income</span>, <span class="fl">9999999</span>)
<span class="co">#&gt;  [1]  28000 148800 479000  85000  41900     NA 149000  98800  90750  45010</span>
<span class="co">#&gt; [11] 127000  21600  74200  61000  20000  77400     NA  47100  23800  33200</span></pre></body></html></div>
<p>The new variable has <code>NA</code>s in the place of those strings of 9s.</p>
<p>As an alternative, we can use the <code>magrittr</code> pipe (<code><a href="https://dplyr.tidyverse.org/reference/reexports.html">%&gt;%</a></code>) to pass an input into <code><a href="../reference/na_if_in.html">na_if_in()</a></code>:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">income</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="fl">9999999</span>)
<span class="co">#&gt;  [1]  28000 148800 479000  85000  41900     NA 149000  98800  90750  45010</span>
<span class="co">#&gt; [11] 127000  21600  74200  61000  20000  77400     NA  47100  23800  33200</span></pre></body></html></div>
<p>This produces the same result.</p>
<p>This task could have been completed using the version of <code><a href="../reference/na_if_in.html">na_if_in()</a></code> included in the <code>dplyr</code> package. However, moving forward we will use more advanced functionality of <code>fauxnaif</code>.</p>
</div>
<div id="replacing-multiple-values" class="section level1">
<h1 class="hasAnchor">
<a href="#replacing-multiple-values" class="anchor"></a>Replacing multiple values</h1>
<p>Let’s now examine the age variable:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span>
<span class="co">#&gt;  [1]  80  89  48  63  47  57  49  50 557  33  30  42  22   2  28  34  64  68  39</span>
<span class="co">#&gt; [20]  73</span></pre></body></html></div>
<p>In this case, we see two improbable values: 557 and 2 (assuming this is a survey of adults). Using <code>dplyr</code>, this would have to be addressed using two steps:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span>(<span class="fl">557</span>) <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span>(<span class="fl">2</span>)
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
<p>But using <code>fauxnaif</code> we can simplify this to a single step:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="fl">557</span>, <span class="fl">2</span>)
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
</div>
<div id="specifying-values-to-keep-rather-than-values-to-discard" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-values-to-keep-rather-than-values-to-discard" class="anchor"></a>Specifying values to keep rather than values to discard</h1>
<p>In the above example, we were able to examine our dataset and select the values that were unrealistic. In real-life analyses, we often can’t look at each observation one by one to find unrealistic values, but we often do know the range of realistic values. Using <code><a href="../reference/na_if_in.html">na_if_not()</a></code>, we can specify which values are realistic and discard those that are not.</p>
<p>Returning to the age variable, let’s replace values with <code>NA</code> if they are <em>not</em> between 18 (the minimum age we expect to enter the survey) and 122 (the world record for the oldest person).</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_not</a></span>(<span class="fl">18</span>:<span class="fl">122</span>)
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
<p>This has the same effect as specifying the unrealistic values directly, but no longer requires you to directly examine each observation.</p>
</div>
<div id="replacing-values-using-formulas" class="section level1">
<h1 class="hasAnchor">
<a href="#replacing-values-using-formulas" class="anchor"></a>Replacing values using formulas</h1>
<p>Another way to approach this problem is to use a formula to specify the range of acceptable values. This is particularly useful when dealing with non-integer values, where the colon operator (<code>:</code>) will not work:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fl">23</span> <span class="kw">%in%</span> <span class="fl">18</span>:<span class="fl">122</span>
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>but</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fl">23.5</span> <span class="kw">%in%</span> <span class="fl">18</span>:<span class="fl">122</span>
<span class="co">#&gt; [1] FALSE</span></pre></body></html></div>
<p>Formulas in <code>fauxnaif</code> are based on the formula syntax used in <code>rlang</code> and <code>purrr</code>. They are introduced with a tilde (<code>~</code>) and indicate each observation with a dot (<code>.</code>).</p>
<p>To clean the age variable, we will need two formulas. One will replace values less than 18 and another will replace values greater than 122:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(~ <span class="no">.</span> <span class="kw">&lt;</span> <span class="fl">18</span>, ~ <span class="no">.</span> <span class="kw">&gt;</span> <span class="fl">122</span>)
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
<div id="using-relational-operators-from-other-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#using-relational-operators-from-other-packages" class="anchor"></a>Using relational operators from other packages</h2>
<p>If you really want to get this down to a single argument, you can use more advanced relational operators provided by packages like <code>intrval</code>, <code>inops</code>, or <code>invctr</code>.</p>
<p>For example, <code>intrval</code>’s closed interval operator (<code><a href="https://rdrr.io/pkg/intrval/man/intrval.html">%[]%</a></code>) allows you to check if a value is between two values, even if it is not an integer:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">intrval</span>)

<span class="fl">23.5</span> <span class="kw">%[]%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">18</span>, <span class="fl">122</span>)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>With this, we can clean the age variable using only one formula argument:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_not</a></span>(~ <span class="no">.</span> <span class="kw">%[]%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">18</span>, <span class="fl">122</span>))
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
<p>or</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(~ <span class="no">.</span> <span class="kw">%][%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">18</span>, <span class="fl">122</span>))
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
</div>
<div id="using-formulas-for-non-numeric-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#using-formulas-for-non-numeric-variables" class="anchor"></a>Using formulas for non-numeric variables</h2>
<p>Formulas are not only useful when dealing with numeric variables. While it’s straightforward to use relational operators to specify replacements in numeric variables, we can also use more complex formulas to handle other data types.</p>
<p>Let’s take a look at the religion variable:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">religion</span>
<span class="co">#&gt;  [1] "Christian"                           </span>
<span class="co">#&gt;  [2] "Spiritual not religious"             </span>
<span class="co">#&gt;  [3] "Catholic"                            </span>
<span class="co">#&gt;  [4] "christian"                           </span>
<span class="co">#&gt;  [5] "Baptist"                             </span>
<span class="co">#&gt;  [6] "Religion is the opiate of the people"</span>
<span class="co">#&gt;  [7] "methodist"                           </span>
<span class="co">#&gt;  [8] "Lutheran"                            </span>
<span class="co">#&gt;  [9] "Agnostic"                            </span>
<span class="co">#&gt; [10] "Jewish"                              </span>
<span class="co">#&gt; [11] "none"                                </span>
<span class="co">#&gt; [12] "Roman Catholic"                      </span>
<span class="co">#&gt; [13] "atheist"                             </span>
<span class="co">#&gt; [14] "Christian"                           </span>
<span class="co">#&gt; [15] "Not religious"                       </span>
<span class="co">#&gt; [16] "Christian"                           </span>
<span class="co">#&gt; [17] "Nothing"                             </span>
<span class="co">#&gt; [18] "None"                                </span>
<span class="co">#&gt; [19] "baptist"                             </span>
<span class="co">#&gt; [20] "Christian"</span></pre></body></html></div>
<p>While there are a few things we might want to clean in this variable, one clear issue is the respondent who did not answer the question but instead used the space to give an opinion: “Religion is the opiate of the people”.</p>
<p>We could use the most basic form of <code><a href="../reference/na_if_in.html">na_if_in()</a></code> to simply remove this answer:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">religion</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="st">"Religion is the opiate of the people"</span>)
<span class="co">#&gt;  [1] "Christian"               "Spiritual not religious"</span>
<span class="co">#&gt;  [3] "Catholic"                "christian"              </span>
<span class="co">#&gt;  [5] "Baptist"                 NA                       </span>
<span class="co">#&gt;  [7] "methodist"               "Lutheran"               </span>
<span class="co">#&gt;  [9] "Agnostic"                "Jewish"                 </span>
<span class="co">#&gt; [11] "none"                    "Roman Catholic"         </span>
<span class="co">#&gt; [13] "atheist"                 "Christian"              </span>
<span class="co">#&gt; [15] "Not religious"           "Christian"              </span>
<span class="co">#&gt; [17] "Nothing"                 "None"                   </span>
<span class="co">#&gt; [19] "baptist"                 "Christian"</span></pre></body></html></div>
<p>But in a larger analysis, we may prefer to have a simple rule for excluding answers. Perhaps we decide that answers longer than 25 characters are unlikely to be genuine. In that case, we can use a formula operating on the number of characters (<code><a href="https://rdrr.io/r/base/nchar.html">nchar(.)</a></code>) in a response:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">religion</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(~ <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">.</span>) <span class="kw">&gt;</span> <span class="fl">25</span>)
<span class="co">#&gt;  [1] "Christian"               "Spiritual not religious"</span>
<span class="co">#&gt;  [3] "Catholic"                "christian"              </span>
<span class="co">#&gt;  [5] "Baptist"                 NA                       </span>
<span class="co">#&gt;  [7] "methodist"               "Lutheran"               </span>
<span class="co">#&gt;  [9] "Agnostic"                "Jewish"                 </span>
<span class="co">#&gt; [11] "none"                    "Roman Catholic"         </span>
<span class="co">#&gt; [13] "atheist"                 "Christian"              </span>
<span class="co">#&gt; [15] "Not religious"           "Christian"              </span>
<span class="co">#&gt; [17] "Nothing"                 "None"                   </span>
<span class="co">#&gt; [19] "baptist"                 "Christian"</span></pre></body></html></div>
</div>
</div>
<div id="replacing-values-using-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#replacing-values-using-functions" class="anchor"></a>Replacing values using functions</h1>
<p>Finally, there are cases when we can use a simple function to replace values.</p>
<p>Returning to the income variable, we know that <code>NA</code> is indicated using the largest value. Rather than specifying it directly, we can simply tell <code>fauxnaif</code> to replace the variable’s maximum value:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">income</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="no">max</span>)
<span class="co">#&gt;  [1]  28000 148800 479000  85000  41900     NA 149000  98800  90750  45010</span>
<span class="co">#&gt; [11] 127000  21600  74200  61000  20000  77400     NA  47100  23800  33200</span></pre></body></html></div>
<p>We can do the same with the age variable, where both the lowest and highest values are unrealistic:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">faux_census</span>$<span class="no">age</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="no">min</span>, <span class="no">max</span>)
<span class="co">#&gt;  [1] 80 89 48 63 47 57 49 50 NA 33 30 42 22 NA 28 34 64 68 39 73</span></pre></body></html></div>
<p>But beware! If no respondent had given an unrealistic answer, replacing the minimum or maximum values could result in the loss of real data! It is often better to use more complicated formulas than simpler functions for your replacements.</p>
</div>
<div id="replacing-values-in-data-frames" class="section level1">
<h1 class="hasAnchor">
<a href="#replacing-values-in-data-frames" class="anchor"></a>Replacing values in data frames</h1>
<p>Often in data analysis, we prefer to work within a single data frame than operating on individual vectors. <code>fauxnaif</code> is built to handle this use case.</p>
<p>A simple solution is to use <code><a href="../reference/na_if_in.html">na_if_in()</a></code> or <code><a href="../reference/na_if_in.html">na_if_not()</a></code> within <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following object is masked from 'package:fauxnaif':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     na_if</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="no">faux_census</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">income</span> <span class="kw">=</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_in</a></span>(<span class="no">income</span>, <span class="fl">9999999</span>))
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender               age race            income religion              </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 </span>
<span class="co">#&gt;  1 CA     female                80 Native American  28000 Christian             </span>
<span class="co">#&gt;  2 NY     Woman                 89 Latino          148800 Spiritual not religio…</span>
<span class="co">#&gt;  3 CA     Female                48 White           479000 Catholic              </span>
<span class="co">#&gt;  4 TX     Male                  63 latinx           85000 christian             </span>
<span class="co">#&gt;  5 PA     Male                  47 asian            41900 Baptist               </span>
<span class="co">#&gt;  6 TX     Gender is a socia…    57 Race is a soci…     NA Religion is the opiat…</span>
<span class="co">#&gt;  7 Canada Male                  49 white           149000 methodist             </span>
<span class="co">#&gt;  8 TX     Female                50 White            98800 Lutheran              </span>
<span class="co">#&gt;  9 NY     f                    557 white            90750 Agnostic              </span>
<span class="co">#&gt; 10 WA     F                     33 White            45010 Jewish                </span>
<span class="co">#&gt; 11 TX     Male                  30 White           127000 none                  </span>
<span class="co">#&gt; 12 OH     Non-binary            42 Caucasian        21600 Roman Catholic        </span>
<span class="co">#&gt; 13 NC     Female                22 African Americ…  74200 atheist               </span>
<span class="co">#&gt; 14 LA     Male                   2 White            61000 Christian             </span>
<span class="co">#&gt; 15 LA     Female                28 Black            20000 Not religious         </span>
<span class="co">#&gt; 16 CA     male                  34 Asian American   77400 Christian             </span>
<span class="co">#&gt; 17 TN     M                     64 white               NA Nothing               </span>
<span class="co">#&gt; 18 FL     Female                68 white            47100 None                  </span>
<span class="co">#&gt; 19 OH     Male                  39 black            23800 baptist               </span>
<span class="co">#&gt; 20 NH     male                  73 Hispanic         33200 Christian</span></pre></body></html></div>
</div>
<div id="replacing-values-in-multiple-columns" class="section level1">
<h1 class="hasAnchor">
<a href="#replacing-values-in-multiple-columns" class="anchor"></a>Replacing values in multiple columns</h1>
<p>Sometimes, the same replacement function can be used in multiple columns. Here, the respondent who didn’t give a real answer to the religion question seemed to do the same with the gender and race questions. You can specify multiple columns using <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> is you would like to make replacements based on the same criteria:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">faux_census</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">religion</span>, <span class="no">gender</span>, <span class="no">race</span>), <span class="no">na_if_in</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">.</span>) <span class="kw">&gt;</span> <span class="fl">25</span>))
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender       age race              income religion               </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;                  </span>
<span class="co">#&gt;  1 CA     female        80 Native American    28000 Christian              </span>
<span class="co">#&gt;  2 NY     Woman         89 Latino            148800 Spiritual not religious</span>
<span class="co">#&gt;  3 CA     Female        48 White             479000 Catholic               </span>
<span class="co">#&gt;  4 TX     Male          63 latinx             85000 christian              </span>
<span class="co">#&gt;  5 PA     Male          47 asian              41900 Baptist                </span>
<span class="co">#&gt;  6 TX     &lt;NA&gt;          57 &lt;NA&gt;             9999999 &lt;NA&gt;                   </span>
<span class="co">#&gt;  7 Canada Male          49 white             149000 methodist              </span>
<span class="co">#&gt;  8 TX     Female        50 White              98800 Lutheran               </span>
<span class="co">#&gt;  9 NY     f            557 white              90750 Agnostic               </span>
<span class="co">#&gt; 10 WA     F             33 White              45010 Jewish                 </span>
<span class="co">#&gt; 11 TX     Male          30 White             127000 none                   </span>
<span class="co">#&gt; 12 OH     Non-binary    42 Caucasian          21600 Roman Catholic         </span>
<span class="co">#&gt; 13 NC     Female        22 African American   74200 atheist                </span>
<span class="co">#&gt; 14 LA     Male           2 White              61000 Christian              </span>
<span class="co">#&gt; 15 LA     Female        28 Black              20000 Not religious          </span>
<span class="co">#&gt; 16 CA     male          34 Asian American     77400 Christian              </span>
<span class="co">#&gt; 17 TN     M             64 white            9999999 Nothing                </span>
<span class="co">#&gt; 18 FL     Female        68 white              47100 None                   </span>
<span class="co">#&gt; 19 OH     Male          39 black              23800 baptist                </span>
<span class="co">#&gt; 20 NH     male          73 Hispanic           33200 Christian</span></pre></body></html></div>
<div id="replacing-values-using-a-predicate-function" class="section level2">
<h2 class="hasAnchor">
<a href="#replacing-values-using-a-predicate-function" class="anchor"></a>Replacing values using a predicate function</h2>
<p>Rather than specifying columns manually, we can also select columns using a predicate function with <code>dplyr</code>’s <code>where()</code>.</p>
<p>For example, we may want to remove strings of 9s in any numeric column:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">faux_census</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span>(<span class="fu">where</span>(<span class="no">is.numeric</span>), <span class="no">na_if_in</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"999"</span>, <span class="no">.</span>)))
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender               age race            income religion              </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 </span>
<span class="co">#&gt;  1 CA     female                80 Native American  28000 Christian             </span>
<span class="co">#&gt;  2 NY     Woman                 89 Latino          148800 Spiritual not religio…</span>
<span class="co">#&gt;  3 CA     Female                48 White           479000 Catholic              </span>
<span class="co">#&gt;  4 TX     Male                  63 latinx           85000 christian             </span>
<span class="co">#&gt;  5 PA     Male                  47 asian            41900 Baptist               </span>
<span class="co">#&gt;  6 TX     Gender is a socia…    57 Race is a soci…     NA Religion is the opiat…</span>
<span class="co">#&gt;  7 Canada Male                  49 white           149000 methodist             </span>
<span class="co">#&gt;  8 TX     Female                50 White            98800 Lutheran              </span>
<span class="co">#&gt;  9 NY     f                    557 white            90750 Agnostic              </span>
<span class="co">#&gt; 10 WA     F                     33 White            45010 Jewish                </span>
<span class="co">#&gt; 11 TX     Male                  30 White           127000 none                  </span>
<span class="co">#&gt; 12 OH     Non-binary            42 Caucasian        21600 Roman Catholic        </span>
<span class="co">#&gt; 13 NC     Female                22 African Americ…  74200 atheist               </span>
<span class="co">#&gt; 14 LA     Male                   2 White            61000 Christian             </span>
<span class="co">#&gt; 15 LA     Female                28 Black            20000 Not religious         </span>
<span class="co">#&gt; 16 CA     male                  34 Asian American   77400 Christian             </span>
<span class="co">#&gt; 17 TN     M                     64 white               NA Nothing               </span>
<span class="co">#&gt; 18 FL     Female                68 white            47100 None                  </span>
<span class="co">#&gt; 19 OH     Male                  39 black            23800 baptist               </span>
<span class="co">#&gt; 20 NH     male                  73 Hispanic         33200 Christian</span></pre></body></html></div>
</div>
<div id="replacing-values-in-all-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#replacing-values-in-all-columns" class="anchor"></a>Replacing values in all columns</h2>
<p>While this replacement was intended for three specific columns, no variable contains a legitimate answer longer than 25 characters. In this case, rather than specifying the variable of interest, we can simply use <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/reexports.html">everything()</a></code> to make the replacement in all columns:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">faux_census</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">everything</a></span>(), <span class="no">na_if_in</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">.</span>) <span class="kw">&gt;</span> <span class="fl">25</span>))
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender       age race              income religion               </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;                  </span>
<span class="co">#&gt;  1 CA     female        80 Native American    28000 Christian              </span>
<span class="co">#&gt;  2 NY     Woman         89 Latino            148800 Spiritual not religious</span>
<span class="co">#&gt;  3 CA     Female        48 White             479000 Catholic               </span>
<span class="co">#&gt;  4 TX     Male          63 latinx             85000 christian              </span>
<span class="co">#&gt;  5 PA     Male          47 asian              41900 Baptist                </span>
<span class="co">#&gt;  6 TX     &lt;NA&gt;          57 &lt;NA&gt;             9999999 &lt;NA&gt;                   </span>
<span class="co">#&gt;  7 Canada Male          49 white             149000 methodist              </span>
<span class="co">#&gt;  8 TX     Female        50 White              98800 Lutheran               </span>
<span class="co">#&gt;  9 NY     f            557 white              90750 Agnostic               </span>
<span class="co">#&gt; 10 WA     F             33 White              45010 Jewish                 </span>
<span class="co">#&gt; 11 TX     Male          30 White             127000 none                   </span>
<span class="co">#&gt; 12 OH     Non-binary    42 Caucasian          21600 Roman Catholic         </span>
<span class="co">#&gt; 13 NC     Female        22 African American   74200 atheist                </span>
<span class="co">#&gt; 14 LA     Male           2 White              61000 Christian              </span>
<span class="co">#&gt; 15 LA     Female        28 Black              20000 Not religious          </span>
<span class="co">#&gt; 16 CA     male          34 Asian American     77400 Christian              </span>
<span class="co">#&gt; 17 TN     M             64 white            9999999 Nothing                </span>
<span class="co">#&gt; 18 FL     Female        68 white              47100 None                   </span>
<span class="co">#&gt; 19 OH     Male          39 black              23800 baptist                </span>
<span class="co">#&gt; 20 NH     male          73 Hispanic           33200 Christian</span></pre></body></html></div>
</div>
</div>
<div id="putting-it-all-together" class="section level1">
<h1 class="hasAnchor">
<a href="#putting-it-all-together" class="anchor"></a>Putting it all together</h1>
<p>In a data analysis pipeline, we can combine several steps to produce a usable dataset. Combining our interval check for age, our check for strings of 9s in numeric variables, and our check for long responses in character variables, we can yield much cleaner data:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">faux_census</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    <span class="kw">age</span> <span class="kw">=</span> <span class="fu"><a href="../reference/na_if_in.html">na_if_not</a></span>(<span class="no">age</span>, <span class="fl">18</span>:<span class="fl">122</span>),
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span>(<span class="fu">where</span>(<span class="no">is.numeric</span>), <span class="no">na_if_in</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"999"</span>, <span class="no">.</span>)),
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">everything</a></span>(), <span class="no">na_if_in</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">.</span>) <span class="kw">&gt;</span> <span class="fl">25</span>)
  )
<span class="co">#&gt; # A tibble: 20 x 6</span>
<span class="co">#&gt;    state  gender       age race             income religion               </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;                  </span>
<span class="co">#&gt;  1 CA     female        80 Native American   28000 Christian              </span>
<span class="co">#&gt;  2 NY     Woman         89 Latino           148800 Spiritual not religious</span>
<span class="co">#&gt;  3 CA     Female        48 White            479000 Catholic               </span>
<span class="co">#&gt;  4 TX     Male          63 latinx            85000 christian              </span>
<span class="co">#&gt;  5 PA     Male          47 asian             41900 Baptist                </span>
<span class="co">#&gt;  6 TX     &lt;NA&gt;          57 &lt;NA&gt;                 NA &lt;NA&gt;                   </span>
<span class="co">#&gt;  7 Canada Male          49 white            149000 methodist              </span>
<span class="co">#&gt;  8 TX     Female        50 White             98800 Lutheran               </span>
<span class="co">#&gt;  9 NY     f             NA white             90750 Agnostic               </span>
<span class="co">#&gt; 10 WA     F             33 White             45010 Jewish                 </span>
<span class="co">#&gt; 11 TX     Male          30 White            127000 none                   </span>
<span class="co">#&gt; 12 OH     Non-binary    42 Caucasian         21600 Roman Catholic         </span>
<span class="co">#&gt; 13 NC     Female        22 African American  74200 atheist                </span>
<span class="co">#&gt; 14 LA     Male          NA White             61000 Christian              </span>
<span class="co">#&gt; 15 LA     Female        28 Black             20000 Not religious          </span>
<span class="co">#&gt; 16 CA     male          34 Asian American    77400 Christian              </span>
<span class="co">#&gt; 17 TN     M             64 white                NA Nothing                </span>
<span class="co">#&gt; 18 FL     Female        68 white             47100 None                   </span>
<span class="co">#&gt; 19 OH     Male          39 black             23800 baptist                </span>
<span class="co">#&gt; 20 NH     male          73 Hispanic          33200 Christian</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexander Rossell Hayes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
